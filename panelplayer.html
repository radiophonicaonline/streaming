<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
body{background:#111;color:white;font-family:sans-serif;padding:15px}

button{
  margin:5px;
  padding:8px 12px;
  background:#444;
  color:white;
  border:none;
  cursor:pointer;
}

button:hover{background:#666}

#lista div{
  padding:6px;
  border-bottom:1px solid #333;
  cursor:pointer;
}

#lista div:hover{background:#333}
</style>
</head>
<body>

<h2>ğŸ¬ Panel Player</h2>

<button onclick="cargarVideos()">â• Cargar videos</button>
<button onclick="cargarCarpeta()">ğŸ“‚ Cargar carpeta</button>

<hr>

<button onclick="play()">â–¶ Play</button>
<button onclick="pause()">â¸ Pause</button>
<button onclick="stop()">â¹ Stop</button>
<button onclick="next()">ğŸ”€ TransiciÃ³n a otro</button>

<hr>

<h3>ğŸ“‹ Lista</h3>
<div id="lista"></div>

<input type="file" id="files" accept="video/*" multiple hidden>
<input type="file" id="folder" webkitdirectory hidden>

<script>
const canal = new BroadcastChannel("obs_player");

let archivos = [];

const lista = document.getElementById("lista");

function actualizarLista(){
  lista.innerHTML = "";

  archivos.forEach((f,i)=>{
    const div = document.createElement("div");
    div.textContent = f.name;

    div.onclick = ()=>{
      canal.postMessage({
        type:"playIndex",
        files:archivos,
        index:i
      });
    };

    lista.appendChild(div);
  });
}

function cargarVideos(){
  document.getElementById("files").click();
}

function cargarCarpeta(){
  document.getElementById("folder").click();
}

document.getElementById("files").onchange = e=>{
  archivos.push(...e.target.files);
  actualizarLista();
};

document.getElementById("folder").onchange = e=>{
  archivos.push(...e.target.files);
  actualizarLista();
};

function play(){ canal.postMessage({type:"play"}) }
function pause(){ canal.postMessage({type:"pause"}) }
function stop(){ canal.postMessage({type:"stop"}) }
function next(){ canal.postMessage({type:"next"}) }
</script>

</body>
</html>
